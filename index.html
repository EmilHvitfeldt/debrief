<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Text-Based Summaries for profvis Profiling Data • debrief</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Text-Based Summaries for profvis Profiling Data">
<meta name="description" content="Provides text-based summaries and analysis tools for profvis profiling output. Designed for terminal workflows and AI agent consumption, offering views including hotspot analysis, call trees, source context, caller/callee relationships, and memory allocation breakdowns.">
<meta property="og:description" content="Provides text-based summaries and analysis tools for profvis profiling output. Designed for terminal workflows and AI agent consumption, offering views including hotspot analysis, call trees, source context, caller/callee relationships, and memory allocation breakdowns.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">debrief</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/case-study-tidypredict.html">Case study: Using debrief for iterative R performance optimization</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emilhvitfeldt/debrief/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="debrief">debrief<a class="anchor" aria-label="anchor" href="#debrief"></a>
</h1></div>
<!-- badges: start -->

<p>debrief provides text-based summaries and analysis tools for <a href="https://rstudio.github.io/profvis/" class="external-link">profvis</a> profiling output. It’s designed for terminal workflows and AI agent consumption, offering views including hotspot analysis, call trees, source context, caller/callee relationships, and memory allocation breakdowns.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of debrief from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"emilhvitfeldt/debrief"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://profvis.r-lib.org" class="external-link">profvis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/emilhvitfeldt/debrief" class="external-link">debrief</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Profile some code</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://profvis.r-lib.org/reference/profvis.html" class="external-link">profvis</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="co"># your code here</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get help on available functions</span></span>
<span><span class="fu"><a href="reference/pv_help.html">pv_help</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Start with a summary</span></span>
<span><span class="fu"><a href="reference/pv_print_debrief.html">pv_print_debrief</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="typical-workflow">Typical Workflow<a class="anchor" aria-label="anchor" href="#typical-workflow"></a>
</h2>
<p>debrief is designed for iterative profiling. Each function prints “Next steps” suggestions to guide you deeper:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fl">1.</span> <span class="fu">pv_print_debrief</span>(p)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a> <span class="ot">-&gt;</span> Overview<span class="sc">:</span> identifies hot functions and lines</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="fl">2.</span> <span class="fu">pv_focus</span>(p, <span class="st">"hot_function"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a> <span class="ot">-&gt;</span> Deep dive<span class="sc">:</span> time breakdown, callers, callees, source</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fl">3.</span> <span class="fu">pv_hot_lines</span>(p)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a> <span class="ot">-&gt;</span> Exact lines<span class="sc">:</span> find the specific code consuming time</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="fl">4.</span> <span class="fu">pv_source_context</span>(p, <span class="st">"file.R"</span>)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a> <span class="ot">-&gt;</span> Code view<span class="sc">:</span> see source with profiling data overlay</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="fl">5.</span> <span class="fu">pv_suggestions</span>(p)</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a> <span class="ot">-&gt;</span> Actions<span class="sc">:</span> get specific optimization recommendations</span></code></pre></div>
<p>The <code><a href="reference/pv_help.html">pv_help()</a></code> function lists all available functions by category.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>First, create a profvis profile of some code. To get source references in the profile, write your code to a file and source it with <code>keep.source = TRUE</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://profvis.r-lib.org" class="external-link">profvis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/emilhvitfeldt/debrief" class="external-link">debrief</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Write functions to a temp file for source references</span></span>
<span><span class="va">example_code</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">process_data &lt;- function(n) {</span></span>
<span><span class="st">  raw &lt;- generate_data(n)</span></span>
<span><span class="st">  cleaned &lt;- clean_data(raw)</span></span>
<span><span class="st">  summarize_data(cleaned)</span></span>
<span><span class="st">}</span></span>
<span><span class="st"></span></span>
<span><span class="st">generate_data &lt;- function(n) {</span></span>
<span><span class="st">  x &lt;- rnorm(n)</span></span>
<span><span class="st">  y &lt;- runif(n)</span></span>
<span><span class="st">  data.frame(x = x, y = y, z = x * y)</span></span>
<span><span class="st">}</span></span>
<span><span class="st"></span></span>
<span><span class="st">clean_data &lt;- function(df) {</span></span>
<span><span class="st">  df &lt;- df[complete.cases(df), ]</span></span>
<span><span class="st">  df$x_scaled &lt;- scale(df$x)</span></span>
<span><span class="st">  df$category &lt;- cut(df$y, breaks = 5)</span></span>
<span><span class="st">  df</span></span>
<span><span class="st">}</span></span>
<span><span class="st"></span></span>
<span><span class="st">summarize_data &lt;- function(df) {</span></span>
<span><span class="st">  list(</span></span>
<span><span class="st">    means = colMeans(df[, c("x", "y", "z")]),</span></span>
<span><span class="st">    sds = apply(df[, c("x", "y", "z")], 2, sd),</span></span>
<span><span class="st">    counts = table(df$category),</span></span>
<span><span class="st">    text = paste(round(df$x, 2), collapse = ", ")</span></span>
<span><span class="st">  )</span></span>
<span><span class="st">}</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">example_code</span>, <span class="st">"analysis.R"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"analysis.R"</span>, keep.source <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Profile the data pipeline</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://profvis.r-lib.org/reference/profvis.html" class="external-link">profvis</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu">process_data</span><span class="op">(</span><span class="fl">1e5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"analysis.R"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="quick-summary">Quick Summary<a class="anchor" aria-label="anchor" href="#quick-summary"></a>
</h3>
<p>Get a comprehensive overview with <code><a href="reference/pv_print_debrief.html">pv_print_debrief()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/pv_print_debrief.html">pv_print_debrief</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="co">#&gt; ## PROFILING SUMMARY</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total time: 180 ms (18 samples @ 10 ms interval)</span></span>
<span><span class="co">#&gt; Source references: available</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### TOP FUNCTIONS BY SELF-TIME</span></span>
<span><span class="co">#&gt;    110 ms ( 61.1%)  paste</span></span>
<span><span class="co">#&gt;     10 ms (  5.6%)  .bincode</span></span>
<span><span class="co">#&gt;     10 ms (  5.6%)  anyDuplicated.default</span></span>
<span><span class="co">#&gt;     10 ms (  5.6%)  apply</span></span>
<span><span class="co">#&gt;     10 ms (  5.6%)  factor</span></span>
<span><span class="co">#&gt;     10 ms (  5.6%)  match.arg</span></span>
<span><span class="co">#&gt;     10 ms (  5.6%)  runif</span></span>
<span><span class="co">#&gt;     10 ms (  5.6%)  unlist</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### TOP FUNCTIONS BY TOTAL TIME</span></span>
<span><span class="co">#&gt;    180 ms (100.0%)  FUN</span></span>
<span><span class="co">#&gt;    180 ms (100.0%)  lapply</span></span>
<span><span class="co">#&gt;    180 ms (100.0%)  process_data</span></span>
<span><span class="co">#&gt;    130 ms ( 72.2%)  summarize_data</span></span>
<span><span class="co">#&gt;    110 ms ( 61.1%)  paste</span></span>
<span><span class="co">#&gt;     30 ms ( 16.7%)  clean_data</span></span>
<span><span class="co">#&gt;     20 ms ( 11.1%)  cut.default</span></span>
<span><span class="co">#&gt;     20 ms ( 11.1%)  generate_data</span></span>
<span><span class="co">#&gt;     10 ms (  5.6%)  .bincode</span></span>
<span><span class="co">#&gt;     10 ms (  5.6%)  [.data.frame</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### HOT LINES (by self-time)</span></span>
<span><span class="co">#&gt;    120 ms ( 66.7%)  analysis.R:22</span></span>
<span><span class="co">#&gt;                    list(</span></span>
<span><span class="co">#&gt;     10 ms (  5.6%)  analysis.R:10</span></span>
<span><span class="co">#&gt;                    y &lt;- runif(n)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### HOT CALL PATHS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 110 ms (61.1%) - 11 samples:</span></span>
<span><span class="co">#&gt;     lapply</span></span>
<span><span class="co">#&gt;   -&gt; FUN</span></span>
<span><span class="co">#&gt;   -&gt; process_data</span></span>
<span><span class="co">#&gt;   -&gt; summarize_data (analysis.R:5)</span></span>
<span><span class="co">#&gt;   -&gt; paste (analysis.R:22)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 10 ms (5.6%) - 1 samples:</span></span>
<span><span class="co">#&gt;     lapply</span></span>
<span><span class="co">#&gt;   -&gt; FUN</span></span>
<span><span class="co">#&gt;   -&gt; process_data</span></span>
<span><span class="co">#&gt;   -&gt; clean_data (analysis.R:4)</span></span>
<span><span class="co">#&gt;   -&gt; [.data.frame (analysis.R:15)</span></span>
<span><span class="co">#&gt;   -&gt; anyDuplicated.default</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 10 ms (5.6%) - 1 samples:</span></span>
<span><span class="co">#&gt;     lapply</span></span>
<span><span class="co">#&gt;   -&gt; FUN</span></span>
<span><span class="co">#&gt;   -&gt; process_data</span></span>
<span><span class="co">#&gt;   -&gt; clean_data (analysis.R:4)</span></span>
<span><span class="co">#&gt;   -&gt; cut.default</span></span>
<span><span class="co">#&gt;   -&gt; .bincode</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 10 ms (5.6%) - 1 samples:</span></span>
<span><span class="co">#&gt;     lapply</span></span>
<span><span class="co">#&gt;   -&gt; FUN</span></span>
<span><span class="co">#&gt;   -&gt; process_data</span></span>
<span><span class="co">#&gt;   -&gt; clean_data (analysis.R:4)</span></span>
<span><span class="co">#&gt;   -&gt; cut.default</span></span>
<span><span class="co">#&gt;   -&gt; factor</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 10 ms (5.6%) - 1 samples:</span></span>
<span><span class="co">#&gt;     lapply</span></span>
<span><span class="co">#&gt;   -&gt; FUN</span></span>
<span><span class="co">#&gt;   -&gt; process_data</span></span>
<span><span class="co">#&gt;   -&gt; generate_data (analysis.R:3)</span></span>
<span><span class="co">#&gt;   -&gt; data.frame (analysis.R:11)</span></span>
<span><span class="co">#&gt;   -&gt; make.names</span></span>
<span><span class="co">#&gt;   -&gt; order</span></span>
<span><span class="co">#&gt;   -&gt; match.arg</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### MEMORY ALLOCATION (by function)</span></span>
<span><span class="co">#&gt;    41.03 MB paste</span></span>
<span><span class="co">#&gt;    10.01 MB anyDuplicated.default</span></span>
<span><span class="co">#&gt;     2.90 MB match.arg</span></span>
<span><span class="co">#&gt;     2.38 MB runif</span></span>
<span><span class="co">#&gt;     0.61 MB unlist</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### MEMORY ALLOCATION (by line)</span></span>
<span><span class="co">#&gt;    41.03 MB analysis.R:22</span></span>
<span><span class="co">#&gt;             list(</span></span>
<span><span class="co">#&gt;     2.38 MB analysis.R:10</span></span>
<span><span class="co">#&gt;             y &lt;- runif(n)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Next steps</span></span>
<span><span class="co">#&gt; pv_focus(p, "paste")</span></span>
<span><span class="co">#&gt; pv_source_context(p, "analysis.R")</span></span>
<span><span class="co">#&gt; pv_suggestions(p)</span></span>
<span><span class="co">#&gt; pv_help()</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="time-analysis">Time Analysis<a class="anchor" aria-label="anchor" href="#time-analysis"></a>
</h3>
<p>Analyze where time is spent:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Self-time: time spent directly in each function</span></span>
<span><span class="fu"><a href="reference/pv_self_time.html">pv_self_time</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="co">#&gt;                   label samples time_ms  pct</span></span>
<span><span class="co">#&gt; 1                 paste      11     110 61.1</span></span>
<span><span class="co">#&gt; 2              .bincode       1      10  5.6</span></span>
<span><span class="co">#&gt; 3 anyDuplicated.default       1      10  5.6</span></span>
<span><span class="co">#&gt; 4                 apply       1      10  5.6</span></span>
<span><span class="co">#&gt; 5                factor       1      10  5.6</span></span>
<span><span class="co">#&gt; 6             match.arg       1      10  5.6</span></span>
<span><span class="co">#&gt; 7                 runif       1      10  5.6</span></span>
<span><span class="co">#&gt; 8                unlist       1      10  5.6</span></span>
<span></span>
<span><span class="co"># Total time: time spent in function + all its callees</span></span>
<span><span class="fu"><a href="reference/pv_total_time.html">pv_total_time</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    label samples time_ms   pct</span></span>
<span><span class="co">#&gt; 1                    FUN      18     180 100.0</span></span>
<span><span class="co">#&gt; 2                 lapply      18     180 100.0</span></span>
<span><span class="co">#&gt; 3           process_data      18     180 100.0</span></span>
<span><span class="co">#&gt; 4         summarize_data      13     130  72.2</span></span>
<span><span class="co">#&gt; 5                  paste      11     110  61.1</span></span>
<span><span class="co">#&gt; 6             clean_data       3      30  16.7</span></span>
<span><span class="co">#&gt; 7            cut.default       2      20  11.1</span></span>
<span><span class="co">#&gt; 8          generate_data       2      20  11.1</span></span>
<span><span class="co">#&gt; 9               .bincode       1      10   5.6</span></span>
<span><span class="co">#&gt; 10          [.data.frame       1      10   5.6</span></span>
<span><span class="co">#&gt; 11 anyDuplicated.default       1      10   5.6</span></span>
<span><span class="co">#&gt; 12                 apply       1      10   5.6</span></span>
<span><span class="co">#&gt; 13  as.matrix.data.frame       1      10   5.6</span></span>
<span><span class="co">#&gt; 14              colMeans       1      10   5.6</span></span>
<span><span class="co">#&gt; 15            data.frame       1      10   5.6</span></span>
<span><span class="co">#&gt; 16                factor       1      10   5.6</span></span>
<span><span class="co">#&gt; 17            make.names       1      10   5.6</span></span>
<span><span class="co">#&gt; 18             match.arg       1      10   5.6</span></span>
<span><span class="co">#&gt; 19                 order       1      10   5.6</span></span>
<span><span class="co">#&gt; 20                 runif       1      10   5.6</span></span>
<span><span class="co">#&gt; 21                unlist       1      10   5.6</span></span>
<span></span>
<span><span class="co"># Filter to significant functions only</span></span>
<span><span class="fu"><a href="reference/pv_self_time.html">pv_self_time</a></span><span class="op">(</span><span class="va">p</span>, min_pct <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co"># &gt;= 5% of time</span></span>
<span><span class="co">#&gt;                   label samples time_ms  pct</span></span>
<span><span class="co">#&gt; 1                 paste      11     110 61.1</span></span>
<span><span class="co">#&gt; 2              .bincode       1      10  5.6</span></span>
<span><span class="co">#&gt; 3 anyDuplicated.default       1      10  5.6</span></span>
<span><span class="co">#&gt; 4                 apply       1      10  5.6</span></span>
<span><span class="co">#&gt; 5                factor       1      10  5.6</span></span>
<span><span class="co">#&gt; 6             match.arg       1      10  5.6</span></span>
<span><span class="co">#&gt; 7                 runif       1      10  5.6</span></span>
<span><span class="co">#&gt; 8                unlist       1      10  5.6</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="hot-spots">Hot Spots<a class="anchor" aria-label="anchor" href="#hot-spots"></a>
</h3>
<p>Find the hottest lines and call paths:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Hot source lines with context</span></span>
<span><span class="fu"><a href="reference/pv_print_hot_lines.html">pv_print_hot_lines</a></span><span class="op">(</span><span class="va">p</span>, n <span class="op">=</span> <span class="fl">5</span>, context <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; ## HOT SOURCE LINES</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank 1: analysis.R:22 (120 ms, 66.7%)</span></span>
<span><span class="co">#&gt; Function: paste</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        19: }</span></span>
<span><span class="co">#&gt;        20: </span></span>
<span><span class="co">#&gt;        21: summarize_data &lt;- function(df) {</span></span>
<span><span class="co">#&gt; &gt;      22:   list(</span></span>
<span><span class="co">#&gt;        23:     means = colMeans(df[, c("x", "y", "z")]),</span></span>
<span><span class="co">#&gt;        24:     sds = apply(df[, c("x", "y", "z")], 2, sd),</span></span>
<span><span class="co">#&gt;        25:     counts = table(df$category),</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank 2: analysis.R:10 (10 ms, 5.6%)</span></span>
<span><span class="co">#&gt; Function: runif</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         7: </span></span>
<span><span class="co">#&gt;         8: generate_data &lt;- function(n) {</span></span>
<span><span class="co">#&gt;         9:   x &lt;- rnorm(n)</span></span>
<span><span class="co">#&gt; &gt;      10:   y &lt;- runif(n)</span></span>
<span><span class="co">#&gt;        11:   data.frame(x = x, y = y, z = x * y)</span></span>
<span><span class="co">#&gt;        12: }</span></span>
<span><span class="co">#&gt;        13: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Next steps</span></span>
<span><span class="co">#&gt; pv_focus(p, "paste")</span></span>
<span><span class="co">#&gt; pv_source_context(p, "analysis.R")</span></span>
<span></span>
<span><span class="co"># Hot call paths</span></span>
<span><span class="fu"><a href="reference/pv_print_hot_paths.html">pv_print_hot_paths</a></span><span class="op">(</span><span class="va">p</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; ## HOT CALL PATHS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank 1: 110 ms (61.1%) - 11 samples</span></span>
<span><span class="co">#&gt;     lapply</span></span>
<span><span class="co">#&gt;   -&gt; FUN</span></span>
<span><span class="co">#&gt;   -&gt; process_data</span></span>
<span><span class="co">#&gt;   -&gt; summarize_data (analysis.R:5)</span></span>
<span><span class="co">#&gt;   -&gt; paste (analysis.R:22)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank 2: 10 ms (5.6%) - 1 samples</span></span>
<span><span class="co">#&gt;     lapply</span></span>
<span><span class="co">#&gt;   -&gt; FUN</span></span>
<span><span class="co">#&gt;   -&gt; process_data</span></span>
<span><span class="co">#&gt;   -&gt; clean_data (analysis.R:4)</span></span>
<span><span class="co">#&gt;   -&gt; [.data.frame (analysis.R:15)</span></span>
<span><span class="co">#&gt;   -&gt; anyDuplicated.default</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank 3: 10 ms (5.6%) - 1 samples</span></span>
<span><span class="co">#&gt;     lapply</span></span>
<span><span class="co">#&gt;   -&gt; FUN</span></span>
<span><span class="co">#&gt;   -&gt; process_data</span></span>
<span><span class="co">#&gt;   -&gt; clean_data (analysis.R:4)</span></span>
<span><span class="co">#&gt;   -&gt; cut.default</span></span>
<span><span class="co">#&gt;   -&gt; .bincode</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank 4: 10 ms (5.6%) - 1 samples</span></span>
<span><span class="co">#&gt;     lapply</span></span>
<span><span class="co">#&gt;   -&gt; FUN</span></span>
<span><span class="co">#&gt;   -&gt; process_data</span></span>
<span><span class="co">#&gt;   -&gt; clean_data (analysis.R:4)</span></span>
<span><span class="co">#&gt;   -&gt; cut.default</span></span>
<span><span class="co">#&gt;   -&gt; factor</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank 5: 10 ms (5.6%) - 1 samples</span></span>
<span><span class="co">#&gt;     lapply</span></span>
<span><span class="co">#&gt;   -&gt; FUN</span></span>
<span><span class="co">#&gt;   -&gt; process_data</span></span>
<span><span class="co">#&gt;   -&gt; generate_data (analysis.R:3)</span></span>
<span><span class="co">#&gt;   -&gt; data.frame (analysis.R:11)</span></span>
<span><span class="co">#&gt;   -&gt; make.names</span></span>
<span><span class="co">#&gt;   -&gt; order</span></span>
<span><span class="co">#&gt;   -&gt; match.arg</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank 6: 10 ms (5.6%) - 1 samples</span></span>
<span><span class="co">#&gt;     lapply</span></span>
<span><span class="co">#&gt;   -&gt; FUN</span></span>
<span><span class="co">#&gt;   -&gt; process_data</span></span>
<span><span class="co">#&gt;   -&gt; generate_data (analysis.R:3)</span></span>
<span><span class="co">#&gt;   -&gt; runif (analysis.R:10)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank 7: 10 ms (5.6%) - 1 samples</span></span>
<span><span class="co">#&gt;     lapply</span></span>
<span><span class="co">#&gt;   -&gt; FUN</span></span>
<span><span class="co">#&gt;   -&gt; process_data</span></span>
<span><span class="co">#&gt;   -&gt; summarize_data (analysis.R:5)</span></span>
<span><span class="co">#&gt;   -&gt; apply (analysis.R:22)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank 8: 10 ms (5.6%) - 1 samples</span></span>
<span><span class="co">#&gt;     lapply</span></span>
<span><span class="co">#&gt;   -&gt; FUN</span></span>
<span><span class="co">#&gt;   -&gt; process_data</span></span>
<span><span class="co">#&gt;   -&gt; summarize_data (analysis.R:5)</span></span>
<span><span class="co">#&gt;   -&gt; colMeans (analysis.R:22)</span></span>
<span><span class="co">#&gt;   -&gt; as.matrix.data.frame</span></span>
<span><span class="co">#&gt;   -&gt; unlist</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Next steps</span></span>
<span><span class="co">#&gt; pv_focus(p, "paste")</span></span>
<span><span class="co">#&gt; pv_flame(p)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="function-analysis">Function Analysis<a class="anchor" aria-label="anchor" href="#function-analysis"></a>
</h3>
<p>Deep dive into a specific function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/pv_focus.html">pv_focus</a></span><span class="op">(</span><span class="va">p</span>, <span class="st">"clean_data"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ## FOCUS: clean_data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Time Analysis</span></span>
<span><span class="co">#&gt;   Total time:       30 ms ( 16.7%)  - time on call stack</span></span>
<span><span class="co">#&gt;   Self time:         0 ms (  0.0%)  - time at top of stack</span></span>
<span><span class="co">#&gt;   Child time:       30 ms ( 16.7%)  - time in callees</span></span>
<span><span class="co">#&gt;   Appearances:       3 samples</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Called By</span></span>
<span><span class="co">#&gt;       3 calls (100.0%)  process_data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Calls To</span></span>
<span><span class="co">#&gt;       2 calls ( 66.7%)  cut.default</span></span>
<span><span class="co">#&gt;       1 calls ( 33.3%)  [.data.frame</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Source Locations</span></span>
<span><span class="co">#&gt;   No self-time with source info.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Next steps</span></span>
<span><span class="co">#&gt; pv_focus(p, "cut.default")</span></span>
<span><span class="co">#&gt; pv_callers(p, "clean_data")</span></span>
<span><span class="co">#&gt; pv_focus(p, "process_data")</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="call-relationships">Call Relationships<a class="anchor" aria-label="anchor" href="#call-relationships"></a>
</h3>
<p>Understand who calls what:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Who calls this function?</span></span>
<span><span class="fu"><a href="reference/pv_callers.html">pv_callers</a></span><span class="op">(</span><span class="va">p</span>, <span class="st">"clean_data"</span><span class="op">)</span></span>
<span><span class="co">#&gt;          label samples pct</span></span>
<span><span class="co">#&gt; 1 process_data       3 100</span></span>
<span></span>
<span><span class="co"># What does this function call?</span></span>
<span><span class="fu"><a href="reference/pv_callees.html">pv_callees</a></span><span class="op">(</span><span class="va">p</span>, <span class="st">"process_data"</span><span class="op">)</span></span>
<span><span class="co">#&gt;            label samples  pct</span></span>
<span><span class="co">#&gt; 1 summarize_data      13 72.2</span></span>
<span><span class="co">#&gt; 2     clean_data       3 16.7</span></span>
<span><span class="co">#&gt; 3  generate_data       2 11.1</span></span>
<span></span>
<span><span class="co"># Full caller/callee analysis</span></span>
<span><span class="fu"><a href="reference/pv_print_callers_callees.html">pv_print_callers_callees</a></span><span class="op">(</span><span class="va">p</span>, <span class="st">"summarize_data"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ## FUNCTION ANALYSIS: summarize_data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total time: 130 ms (72.2% of profile)</span></span>
<span><span class="co">#&gt; Appearances: 13 samples</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Called by</span></span>
<span><span class="co">#&gt;      13 samples (100.0%)  process_data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Calls to</span></span>
<span><span class="co">#&gt;      11 samples ( 84.6%)  paste</span></span>
<span><span class="co">#&gt;       1 samples (  7.7%)  apply</span></span>
<span><span class="co">#&gt;       1 samples (  7.7%)  colMeans</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Next steps</span></span>
<span><span class="co">#&gt; pv_focus(p, "summarize_data")</span></span>
<span><span class="co">#&gt; pv_focus(p, "process_data")</span></span>
<span><span class="co">#&gt; pv_focus(p, "paste")</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="memory-analysis">Memory Analysis<a class="anchor" aria-label="anchor" href="#memory-analysis"></a>
</h3>
<p>Track memory allocations:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Memory by function</span></span>
<span><span class="fu"><a href="reference/pv_print_memory.html">pv_print_memory</a></span><span class="op">(</span><span class="va">p</span>, n <span class="op">=</span> <span class="fl">10</span>, by <span class="op">=</span> <span class="st">"function"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ## MEMORY ALLOCATION BY FUNCTION</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    41.03 MB paste</span></span>
<span><span class="co">#&gt;    10.01 MB anyDuplicated.default</span></span>
<span><span class="co">#&gt;     2.90 MB match.arg</span></span>
<span><span class="co">#&gt;     2.38 MB runif</span></span>
<span><span class="co">#&gt;     0.61 MB unlist</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Next steps</span></span>
<span><span class="co">#&gt; pv_focus(p, "paste")</span></span>
<span><span class="co">#&gt; pv_gc_pressure(p)</span></span>
<span></span>
<span><span class="co"># Memory by source line</span></span>
<span><span class="fu"><a href="reference/pv_print_memory.html">pv_print_memory</a></span><span class="op">(</span><span class="va">p</span>, n <span class="op">=</span> <span class="fl">10</span>, by <span class="op">=</span> <span class="st">"line"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ## MEMORY ALLOCATION BY LINE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    41.03 MB analysis.R:22</span></span>
<span><span class="co">#&gt;             list(</span></span>
<span><span class="co">#&gt;     2.38 MB analysis.R:10</span></span>
<span><span class="co">#&gt;             y &lt;- runif(n)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Next steps</span></span>
<span><span class="co">#&gt; pv_focus(p, "paste")</span></span>
<span><span class="co">#&gt; pv_source_context(p, "analysis.R")</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="text-based-flame-graph">Text-based Flame Graph<a class="anchor" aria-label="anchor" href="#text-based-flame-graph"></a>
</h3>
<p>Visualize the call tree:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/pv_flame.html">pv_flame</a></span><span class="op">(</span><span class="va">p</span>, width <span class="op">=</span> <span class="fl">70</span>, min_pct <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; ## FLAME GRAPH (text)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total time: 180 ms | Width: 70 chars | Min: 2%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [======================================================================] (root) 100%</span></span>
<span><span class="co">#&gt; [======================================================================]   lapply (100.0%)</span></span>
<span><span class="co">#&gt; [======================================================================]     FUN (100.0%)</span></span>
<span><span class="co">#&gt; [======================================================================]       process_data (100.0%)</span></span>
<span><span class="co">#&gt; [===================================================                   ]         summarize_data (72.2%)</span></span>
<span><span class="co">#&gt; [============                                                          ]         clean_data (16.7%)</span></span>
<span><span class="co">#&gt; [========                                                              ]         generate_data (11.1%)</span></span>
<span><span class="co">#&gt; [===========================================                           ]           paste (61.1%)</span></span>
<span><span class="co">#&gt; [========                                                              ]           cut.default (11.1%)</span></span>
<span><span class="co">#&gt; [====                                                                  ]           runif (5.6%)</span></span>
<span><span class="co">#&gt; [====                                                                  ]           data.frame (5.6%)</span></span>
<span><span class="co">#&gt; [====                                                                  ]           apply (5.6%)</span></span>
<span><span class="co">#&gt; [====                                                                  ]           [.data.frame (5.6%)</span></span>
<span><span class="co">#&gt; [====                                                                  ]           colMeans (5.6%)</span></span>
<span><span class="co">#&gt; [====                                                                  ]             factor (5.6%)</span></span>
<span><span class="co">#&gt; [====                                                                  ]             .bincode (5.6%)</span></span>
<span><span class="co">#&gt; [====                                                                  ]             make.names (5.6%)</span></span>
<span><span class="co">#&gt; [====                                                                  ]             anyDuplicated.default (5.6%)</span></span>
<span><span class="co">#&gt; [====                                                                  ]             as.matrix.data.frame (5.6%)</span></span>
<span><span class="co">#&gt; [====                                                                  ]               order (5.6%)</span></span>
<span><span class="co">#&gt; [====                                                                  ]               unlist (5.6%)</span></span>
<span><span class="co">#&gt; [====                                                                  ]                 match.arg (5.6%)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Legend: [====] = time spent, width proportional to time</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Next steps</span></span>
<span><span class="co">#&gt; pv_focus(p, "lapply")</span></span>
<span><span class="co">#&gt; pv_hot_paths(p)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="compare-profiles">Compare Profiles<a class="anchor" aria-label="anchor" href="#compare-profiles"></a>
</h3>
<p>Measure optimization impact:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Approach 1: Growing vectors in a loop (slow)</span></span>
<span><span class="va">p_slow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://profvis.r-lib.org/reference/profvis.html" class="external-link">profvis</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20000</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">result</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Approach 2: Vectorized with memory allocation</span></span>
<span><span class="va">p_fast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://profvis.r-lib.org/reference/profvis.html" class="external-link">profvis</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5e6</span><span class="op">)</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">50000</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare two profiles</span></span>
<span><span class="fu"><a href="reference/pv_print_compare.html">pv_print_compare</a></span><span class="op">(</span><span class="va">p_slow</span>, <span class="va">p_fast</span><span class="op">)</span></span>
<span><span class="co">#&gt; ## PROFILE COMPARISON</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Overall</span></span>
<span><span class="co">#&gt; before_ms: 270</span></span>
<span><span class="co">#&gt; after_ms: 200</span></span>
<span><span class="co">#&gt; diff_ms: -70</span></span>
<span><span class="co">#&gt; speedup: 1.35x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Biggest Changes</span></span>
<span><span class="co">#&gt; Function                           Before      After       Diff   Change</span></span>
<span><span class="co">#&gt; c                                     220          0       -220    -100%</span></span>
<span><span class="co">#&gt; head                                    0         90        +90      new</span></span>
<span><span class="co">#&gt; rnorm                                   0         60        +60      new</span></span>
<span><span class="co">#&gt; &lt;GC&gt;                                   50         40        -10     -20%</span></span>
<span><span class="co">#&gt; paste                                   0         10        +10      new</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Top Improvements</span></span>
<span><span class="co">#&gt;   c: 220 -&gt; 0 (-220 ms)</span></span>
<span><span class="co">#&gt;   &lt;GC&gt;: 50 -&gt; 40 (-10 ms)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Regressions</span></span>
<span><span class="co">#&gt;   head: 0 -&gt; 90 (+90 ms)</span></span>
<span><span class="co">#&gt;   rnorm: 0 -&gt; 60 (+60 ms)</span></span>
<span><span class="co">#&gt;   paste: 0 -&gt; 10 (+10 ms)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Next steps</span></span>
<span><span class="co">#&gt; pv_focus(p_before, "c")</span></span>
<span><span class="co">#&gt; pv_focus(p_after, "c")</span></span>
<span></span>
<span><span class="co"># Approach 3: Data frame operations</span></span>
<span><span class="va">p_dataframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://profvis.r-lib.org/reference/profvis.html" class="external-link">profvis</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1e6</span><span class="op">)</span>,</span>
<span>    b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1e6</span><span class="op">)</span>,</span>
<span>    c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span>, <span class="fl">1e6</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">a</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">b</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">d</span> <span class="op">~</span> <span class="va">c</span>, data <span class="op">=</span> <span class="va">df</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare all three approaches</span></span>
<span><span class="fu"><a href="reference/pv_print_compare_many.html">pv_print_compare_many</a></span><span class="op">(</span></span>
<span>  growing_vector <span class="op">=</span> <span class="va">p_slow</span>,</span>
<span>  vectorized <span class="op">=</span> <span class="va">p_fast</span>,</span>
<span>  dataframe_ops <span class="op">=</span> <span class="va">p_dataframe</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ## MULTI-PROFILE COMPARISON</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank  Profile                    Time (ms)  Samples vs Fastest</span></span>
<span><span class="co">#&gt;   1*  dataframe_ops                    130       13    fastest</span></span>
<span><span class="co">#&gt;   2   vectorized                       200       20      1.54x</span></span>
<span><span class="co">#&gt;   3   growing_vector                   270       27      2.08x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * = fastest</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="diagnostics">Diagnostics<a class="anchor" aria-label="anchor" href="#diagnostics"></a>
</h3>
<p>Detect GC pressure and get optimization suggestions:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Detect GC pressure (indicates memory allocation issues)</span></span>
<span><span class="fu"><a href="reference/pv_print_gc_pressure.html">pv_print_gc_pressure</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="co">#&gt; ## GC PRESSURE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; No significant GC pressure detected (&lt;10% of time).</span></span>
<span><span class="co">#&gt; Run pv_help() to see all available functions.</span></span>
<span></span>
<span><span class="co"># Get actionable optimization suggestions</span></span>
<span><span class="fu"><a href="reference/pv_print_suggestions.html">pv_print_suggestions</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="co">#&gt; ## OPTIMIZATION SUGGESTIONS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Priority 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; category: hot line</span></span>
<span><span class="co">#&gt; location: analysis.R:22</span></span>
<span><span class="co">#&gt; action: Optimize hot line (66.7%)</span></span>
<span><span class="co">#&gt; pattern: paste</span></span>
<span><span class="co">#&gt; potential_impact: 120 ms (66.7%)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; category: hot line</span></span>
<span><span class="co">#&gt; location: analysis.R:10</span></span>
<span><span class="co">#&gt; action: Optimize hot line (5.6%)</span></span>
<span><span class="co">#&gt; pattern: runif</span></span>
<span><span class="co">#&gt; potential_impact: 10 ms (5.6%)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Priority 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; category: hot function</span></span>
<span><span class="co">#&gt; location: paste</span></span>
<span><span class="co">#&gt; action: Profile in isolation (61.1% self-time)</span></span>
<span><span class="co">#&gt; pattern: paste</span></span>
<span><span class="co">#&gt; potential_impact: 110 ms (61.1%)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Priority 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; category: string operations</span></span>
<span><span class="co">#&gt; location: paste</span></span>
<span><span class="co">#&gt; action: Optimize string operations (61.1%)</span></span>
<span><span class="co">#&gt; pattern: string ops in loops, regex without fixed=TRUE</span></span>
<span><span class="co">#&gt; replacement: pre-compute, fixed=TRUE, stringi package</span></span>
<span><span class="co">#&gt; potential_impact: Up to 55 ms (31%)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Next steps</span></span>
<span><span class="co">#&gt; pv_hot_lines(p)</span></span>
<span><span class="co">#&gt; pv_gc_pressure(p)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="export-for-ai-agents">Export for AI Agents<a class="anchor" aria-label="anchor" href="#export-for-ai-agents"></a>
</h3>
<p>Export structured data for programmatic access:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Export as R list for programmatic access</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pv_to_list.html">pv_to_list</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "metadata"    "summary"     "self_time"   "total_time"  "hot_lines"  </span></span>
<span><span class="co">#&gt; [6] "memory"      "gc_pressure" "suggestions" "recursive"</span></span>
<span></span>
<span><span class="co"># Data frame of functions by self-time</span></span>
<span><span class="va">results</span><span class="op">$</span><span class="va">self_time</span></span>
<span><span class="co">#&gt;                   label samples time_ms  pct</span></span>
<span><span class="co">#&gt; 1                 paste      11     110 61.1</span></span>
<span><span class="co">#&gt; 2              .bincode       1      10  5.6</span></span>
<span><span class="co">#&gt; 3 anyDuplicated.default       1      10  5.6</span></span>
<span><span class="co">#&gt; 4                 apply       1      10  5.6</span></span>
<span><span class="co">#&gt; 5                factor       1      10  5.6</span></span>
<span><span class="co">#&gt; 6             match.arg       1      10  5.6</span></span>
<span><span class="co">#&gt; 7                 runif       1      10  5.6</span></span>
<span><span class="co">#&gt; 8                unlist       1      10  5.6</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="available-functions">Available Functions<a class="anchor" aria-label="anchor" href="#available-functions"></a>
</h2>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Category</th>
<th>Functions</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Overview</td>
<td>
<code><a href="reference/pv_help.html">pv_help()</a></code>, <code><a href="reference/pv_debrief.html">pv_debrief()</a></code>, <code><a href="reference/pv_print_debrief.html">pv_print_debrief()</a></code>, <code><a href="reference/pv_example.html">pv_example()</a></code>
</td>
</tr>
<tr class="even">
<td>Time Analysis</td>
<td>
<code><a href="reference/pv_self_time.html">pv_self_time()</a></code>, <code><a href="reference/pv_total_time.html">pv_total_time()</a></code>
</td>
</tr>
<tr class="odd">
<td>Hot Spots</td>
<td>
<code><a href="reference/pv_hot_lines.html">pv_hot_lines()</a></code>, <code><a href="reference/pv_hot_paths.html">pv_hot_paths()</a></code>, <code><a href="reference/pv_worst_line.html">pv_worst_line()</a></code>, <code><a href="reference/pv_print_hot_lines.html">pv_print_hot_lines()</a></code>, <code><a href="reference/pv_print_hot_paths.html">pv_print_hot_paths()</a></code>
</td>
</tr>
<tr class="even">
<td>Memory</td>
<td>
<code><a href="reference/pv_memory.html">pv_memory()</a></code>, <code><a href="reference/pv_memory_lines.html">pv_memory_lines()</a></code>, <code><a href="reference/pv_print_memory.html">pv_print_memory()</a></code>
</td>
</tr>
<tr class="odd">
<td>Call Analysis</td>
<td>
<code><a href="reference/pv_callers.html">pv_callers()</a></code>, <code><a href="reference/pv_callees.html">pv_callees()</a></code>, <code><a href="reference/pv_call_depth.html">pv_call_depth()</a></code>, <code><a href="reference/pv_call_stats.html">pv_call_stats()</a></code>
</td>
</tr>
<tr class="even">
<td>Function Analysis</td>
<td>
<code><a href="reference/pv_focus.html">pv_focus()</a></code>, <code><a href="reference/pv_recursive.html">pv_recursive()</a></code>
</td>
</tr>
<tr class="odd">
<td>Source Context</td>
<td>
<code><a href="reference/pv_source_context.html">pv_source_context()</a></code>, <code><a href="reference/pv_file_summary.html">pv_file_summary()</a></code>
</td>
</tr>
<tr class="even">
<td>Visualization</td>
<td>
<code><a href="reference/pv_flame.html">pv_flame()</a></code>, <code><a href="reference/pv_flame_condense.html">pv_flame_condense()</a></code>
</td>
</tr>
<tr class="odd">
<td>Comparison</td>
<td>
<code><a href="reference/pv_compare.html">pv_compare()</a></code>, <code><a href="reference/pv_print_compare.html">pv_print_compare()</a></code>, <code><a href="reference/pv_compare_many.html">pv_compare_many()</a></code>, <code><a href="reference/pv_print_compare_many.html">pv_print_compare_many()</a></code>
</td>
</tr>
<tr class="even">
<td>Diagnostics</td>
<td>
<code><a href="reference/pv_gc_pressure.html">pv_gc_pressure()</a></code>, <code><a href="reference/pv_suggestions.html">pv_suggestions()</a></code>
</td>
</tr>
<tr class="odd">
<td>Export</td>
<td>
<code><a href="reference/pv_to_json.html">pv_to_json()</a></code>, <code><a href="reference/pv_to_list.html">pv_to_list()</a></code>
</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="filtering-support">Filtering Support<a class="anchor" aria-label="anchor" href="#filtering-support"></a>
</h3>
<p>Time and hot spot functions support filtering:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter by percentage threshold</span></span>
<span><span class="fu"><a href="reference/pv_self_time.html">pv_self_time</a></span><span class="op">(</span><span class="va">p</span>, min_pct <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/pv_hot_lines.html">pv_hot_lines</a></span><span class="op">(</span><span class="va">p</span>, min_pct <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter by time threshold</span></span>
<span><span class="fu"><a href="reference/pv_self_time.html">pv_self_time</a></span><span class="op">(</span><span class="va">p</span>, min_time_ms <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Limit number of results</span></span>
<span><span class="fu"><a href="reference/pv_self_time.html">pv_self_time</a></span><span class="op">(</span><span class="va">p</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine filters</span></span>
<span><span class="fu"><a href="reference/pv_hot_lines.html">pv_hot_lines</a></span><span class="op">(</span><span class="va">p</span>, n <span class="op">=</span> <span class="fl">5</span>, min_pct <span class="op">=</span> <span class="fl">2</span>, min_time_ms <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/emilhvitfeldt/debrief/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/emilhvitfeldt/debrief/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing debrief</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Emil Hvitfeldt <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://CRAN.R-project.org/package=debrief" class="external-link"><img src="https://www.r-pkg.org/badges/version/debrief" alt="CRAN status"></a></li>
<li><a href="https://github.com/EmilHvitfeldt/debrief/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/EmilHvitfeldt/debrief/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/EmilHvitfeldt/debrief" class="external-link"><img src="https://codecov.io/gh/EmilHvitfeldt/debrief/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Emil Hvitfeldt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
